<template>
    <style>

        .cell{
            min-width: 140px;
            border-left: solid 1px;
        }

        th.cell, #edtCal{
            text-align: center;
        }
     
        td.cell:hover{
            background-color: yellowgreen;
            color: black;
        }

    </style>
    <div class="inline">
        <label for="edtCal">Semana</label>
        <input type="date" id="edtCal">
    </div>
    <div class="week"></div>


</template>
<script>

    const pageData = main_data.agd_grade.data
    const pageFunc = main_data.agd_grade.func
    const pageScreen = document.querySelector('#card-agd_grade')

    pageFunc.pageStart = ()=>{
        pageScreen.querySelector('#edtCal').value = today.getFormatDate()
        make_grid()
    }

    function make_grid(){
        const day = new Date(pageScreen.querySelector('#edtCal').value+' 00:00:00')
        while(day.getDay() > 0){
            day.change(-1)
        }
        const dom = day.getFormatDate()+' 00:00:00'

        const week = pageScreen.querySelector('.week')
        week.innerHTML = ''
        for(let y=-2; y<24; y++){
            const line = document.createElement('tr')
            const head = y==0 ? document.createElement('tr') : null
            const dt = new Date(dom)
            for(let x=0; x<8; x++){            
                const cell = document.createElement(y>=0 & x>0 ? 'td' : 'th')
                cell.innerHTML =  y>=0 ? (x==0 ? y.toString().padStart(2,0)+':00' : '') : (x>0 ? (y==-2 ? dt.getWeekDay() : dt.getFormatBR()) : '')
                cell.className = x==0 ? '' : 'cell'
                x>0 ? cell.id = `d-${dt.getFormatDate()}_${y.toString().padStart(2,0)}:00` : null  
                cell.addEventListener('click',(e)=>{
                    const day = e.target.id.substr(2,10)
                    const time = e.target.id.substr(13,5)

                    console.log(day,time)
                })              
                line.appendChild(cell)

                dt.change()
            }
            week.appendChild(line)
        }
    }

    pageScreen.querySelector('#edtCal').addEventListener('change',()=>{
        make_grid()
    })


    pageFunc.pageStart()

</script>